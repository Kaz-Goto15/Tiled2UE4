# なんかあれば呼んでください 文章での説明が苦手なのでおそらく読んでもわからない部分がいっぱいあると思います


使い方
【準備】
1. Tiled並びにUE4で用いるマップチップを用意します。
2. 使用するマップチップの1x1のタイル幅・高さは確認しておきましょう。

【Tiledでマップを作る】
Tiled: 
1. プロジェクトファイルを作成します。「□型タイル」「CSV」「左から右、上から下」「固定(幅・高さは任意)」「タイル幅・高さ(準備の2. で確認したもの)」
2. 必要に応じてタイルセットを作成します。「名前(任意)」「均等にタイルが並んだ画像を使用」「パス(マップチップの画像)」「タイル幅・高さ(準備の2. で確認したもの)」

【Tiledでエクスポートする】
1. ファイル > 名前をつけてエクスポート




3-1. プロジェクトファイルから見たタイルセットの相対パスを確認します。
3-2. 対応するUE4のタイルセットパスをコピーします。
3-3. 同梱されているlinkPath.json(以下、リンクファイル)を開き、UE4のアセットパスと紐付けます。
　・キーには使用したタイルセットのファイル名(〇〇.tsx)をそのまま入れてください。プロジェクトファイルとタイルセットの階層が違う場合、「../」や「./」にあたる部分を、それぞれ「..\/」「.\/」のように、円マークをスラッシュの前に追加してください。
　・"ue4"には、3-2. でコピーしたパスのうち、'' で囲まれた部分を入れてください。 PaperTileSet'/A/B/C/D.D' のようなパスがコピーされます。
　　このうち、''で囲まれた部分を入れてください。（上の例では、 /A/B/C/D.D の部分）

1. プロジェクトファイルとタイルセットを作成します。 (これらのファイルは同階層で管理することを推奨します。)
2-1. タイルセットを作成後、同梱されているlinkPath.json(以下、リンクファイル)を確認してください。
2-2. リンクファイル内には、デフォルトで２つのタイルセットが紐付けられています。

1. Tiledで制作したマップデータをjson形式でエクスポートします。
2. Tiled2UE4.exeを起動し、ファイルを選択します。 (エクスポートしたファイルをTiled2UE4.exeにD&Dして起動すると、ファイルを選択する過程を飛ばすことができます。)
3. マップデータの変換処理が行われます。任意のキーを押すか、×ボタンなどの基本的な終了コマンドを用いることでウィンドウが閉じられます。
4. 同階層のoutputフォルダに、変換されたファイルが格納されています。 選択したマップデータと同じ名前のjsonファイル(〇〇.json)と同じ名前のテキストファイル(〇〇.txt)が生成されます。
5. UE4を起動し、outputフォルダ内に生成されたjsonファイルをコンテンツブラウザにD&Dします。
6. 5.で生成したタイルマップアセットを開き、outputフォルダ内に生成されたtxtファイルの中身をコピーアンドペーストします。

【よくある質問】
Q. マップチップを変更したい！
A. TiledとUE4の両方に変更を加える必要があります。 
　Tiled：
   1. 変更を加えるタイルセットを開く
   2. "タイルセット" > "タイルセットのプロパティ" でプロパティを開く
   3. プロパティ内の"画像"項目 > "編集"ボタン で、必要に応じてパスの編集やタイル幅・高さの変更を行う
   (4. 3.でタイル幅・高さを変更した場合、それに応じて"マップ" > "マップのプロパティ"でマップの1ブロックあたりの幅と高さを変更する)
  Unreal Engine 4:
   1. 変更を加えるテクスチャアセットを選択
   2. "新しいファイルで再インポート" で画像を選択
   3. テクスチャと紐付いているタイルセットを開き、必要に応じてコリジョンの変更などを行う

Q. 

【Tiled上の注意】
・タイルセット(.tsx)はプロジェクトファイル(.tmx)と同階層に置いてください。
　・階層が違う場合、内部パスが変わるのでパーサーが作動しなくなります。
　・どうしても同階層に置きたくない場合は、都度linkPath.jsonにTiledのタイルセットパスとUEのアセットパスを追記し、紐付けてください。タイルセットパスはエクスポートしたjsonファイル内の"tilesets"キーにあります。

【UE4へのインポートの際の注意】
・パーサを通して生成されるjsonファイルは基本的に変換前のjsonファイルと同じ名前になります。混同せず、outputフォルダ内に生成されたjsonをUE4にインポートするようにしてください。

【linkPath.jsonを編集する際の注意】
・"tiled"には使用したタイルセットのファイル名(〇〇.tsx)をそのまま入れてください。 上記のような例外の場合は、相対パスを入れると上手くいくと思います。
・"ue4"には、コンテンツブラウザ内でアセットをCtrl+Cなどでコピーを行うと PaperTileSet'/Game/Assets/tilemap/tileset_field_TileSet.tileset_field_TileSet' のようなパスがコピーされます。
　このうち、''で囲まれた部分を入れてください。（上の例では、 /Game/Assets/tilemap/tileset_field_TileSet.tileset_field_TileSet の部分）

【変換後の注意】
・Tiledのタイルセットで使用した画像ファイルとUE4のタイルセットで使用した画像ファイル(テクスチャ)は同じ画像になるようにしてください。(画像が同じであればパスが違っても問題ありません)
　・差分があった場合、意図しない地形や空白の地形が入る可能性があります。